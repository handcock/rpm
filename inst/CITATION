# ---- BEGIN STATNET CITATION FUNCTIONS ----
# A header function for ensuring that all the HPMRG packages provide consistent messaging
HPMRG.cite.head <- function(pkg){
  citHeader(
    paste("`",pkg,"` is part of the Statnet suite of packages.  ",
          "If you are using the `",pkg,"` package for research that will be published, ",
          "we request that you acknowledge this by citing the following.\n",
          'For BibTeX format, use toBibtex(citation("',pkg,'")).',
          sep="")
    )
}

# A footer function for ensuring that all the HPMRG packages provide consistent messaging
HPMRG.cite.foot <- function(pkg){
  # the 'meta' variable is be provided by R's CITATION processing script
  citFooter("We have invested a lot of time and effort in creating the",
            "rpm package for use by other researchers.",
            "Please cite it in all papers where it is used. The package",pkg," is made distributed under the terms of the license:",meta$License )
}

# generates a consistent bibentry citation for the software manual of the package
HPMRG.cite.pkg <- function(pkg){
  # the 'meta' variable is provided by R's CITATION processing script
  projhomepage <- "https://github.com/handcock/rpm"
  # compute the list of authors  
  auts <- eval(parse(text=meta$`Authors@R`))
  auts <- auts[sapply(auts, function(aut) "aut" %in% aut$role)]
  # create a citation entry for a "software manual" for this version of the software
  # it will be appended with any specific articles defineded inthe package citation file
  bibentry("Manual",
           author = auts,
           title = paste(meta$Package,": ", meta$Title, sep=""),
           organization = paste("University of California, Los Angeles (\\url{", projhomepage, "})",sep=""),
           year         = substr(meta$Date,1,4),
           note         = paste("R package version ", meta$Version, sep=""),
           url          = paste("https://CRAN.R-project.org/package=",meta$Package,sep="")
           )
}
# ---- END STATNET CITATION FUNCTIONS ----'

# specific citation entries for the rpm package
HPMRG.cite.head("rpm")
HPMRG.cite.pkg("rpm")

bibentry("Manual",
         title = "rpm: Modeling of Revealed Preferences Matchings",
         author = personList(
           as.person("Mark S. Handcock"),
           as.person("Ryan M. Admiraal"),
           as.person("Fiona C. Yeung"),
           as.person("Heide M. Jackson"),
           as.person("Michael S. Rendall"),
           as.person("Shuchi Goyal")
                            ),
         organization = "University of California, Los Angeles",
         year = 2022)

HPMRG.cite.foot("rpm")
